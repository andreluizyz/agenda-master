{% extends "base.html" %}

{% block content %}
   
    <div class="container mt-5 fundo">
        <h1>Seu Painel de Agendamentos</h1>
        <h3>Cadastrar Novo Horário Disponível</h3>
        <form method="POST">
            {{ form.hidden_tag() }}
            <div class="mb-3">
                {{ form.data_hora.label(class="form-label") }}
                <!-- Campo de data e hora atualizado para usar o Flatpickr -->
                <input type="text" id="data_hora" name="data_hora" class="form-control" placeholder="Selecione a data e hora" required>
            </div>
            <div class="mb-3">
                {{ form.submit(class="btn btn-primary") }}
            </div>
        </form>
    </div>

    <div class="container mt-5 fundo">
        <h2>Seus Horários Agendados</h2>
        <table class="table">
            <thead>
                <tr>
                    <th>Horário</th>
                    <th>Domingo</th>
                    <th>Segunda</th>
                    <th>Terça</th>
                    <th>Quarta</th>
                    <th>Quinta</th>
                    <th>Sexta</th>
                    <th>Sábado</th>
                </tr>
            </thead>
            <tbody id="horarios">
                {% for agendamento in agendamentos %}
                    <tr>
                        <td><input type="checkbox" {% if agendamento.disponivel == False %} checked disabled {% endif %}> {{ agendamento.data_hora }}</td>
                        <td><input type="checkbox" {% if agendamento.disponivel == False %} checked disabled {% endif %}></td>
                        <td><input type="checkbox" {% if agendamento.disponivel == False %} checked disabled {% endif %}></td>
                        <td><input type="checkbox" {% if agendamento.disponivel == False %} checked disabled {% endif %}></td>
                        <td><input type="checkbox" {% if agendamento.disponivel == False %} checked disabled {% endif %}></td>
                        <td><input type="checkbox" {% if agendamento.disponivel == False %} checked disabled {% endif %}></td>
                        <td><input type="checkbox" {% if agendamento.disponivel == False %} checked disabled {% endif %}></td>
                        <td><input type="checkbox" {% if agendamento.disponivel == False %} checked disabled {% endif %}></td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
        <button id="adicionarLinha" class="btn btn-success">Adicionar Linha</button>
    </div>

    <script>
        // Inicializa o Flatpickr no campo de data e hora
        flatpickr("#data_hora", {
            enableTime: true,
            dateFormat: "Y-m-d H:i", // Formato de data e hora: Ano-Mês-Dia Hora:Minuto
            time_24hr: true, // Para horário 24h
        });

        // Adiciona uma nova linha na tabela ao clicar no botão
        document.getElementById('adicionarLinha').onclick = function() {
            const table = document.getElementById('horarios');
            const newRow = table.insertRow();
            const horarioCell = newRow.insertCell(0);
            horarioCell.innerHTML = '<input type="checkbox"> 08:30'; // Exemplo de horário, pode ser modificado conforme necessário
            for (let i = 1; i <= 7; i++) {
                const cell = newRow.insertCell(i);
                cell.innerHTML = '<input type="checkbox">';
            }
        };
    </script>
{% endblock %}
